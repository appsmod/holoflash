!function(t,s,i,e){if(t.ion=t.ion||{},!ion.sound){var o=function(s){if(s||(s="undefined"),t.console){console.warn&&"function"==typeof console.warn?console.warn(s):console.log&&"function"==typeof console.log&&console.log(s);var e=i&&i("#debug");if(e&&e.length){var o=e.html();e.html(o+s+"<br/>")}}},n=function(t,s){var i;for(i in s=s||{},t)t.hasOwnProperty(i)&&(s[i]=t[i]);return s};if("function"!=typeof Audio&&"object"!=typeof Audio)s=function(){o("HTML5 Audio is not supported in this browser")},ion.sound=s,ion.sound.play=s,ion.sound.stop=s,ion.sound.pause=s,ion.sound.preload=s,ion.sound.destroy=s,s();else{s=/iPad|iPhone|iPod/.test(s.appVersion);var h,a,p=0,r={},u={};!r.supported&&s?r.supported=["mp3","mp4","aac"]:r.supported||(r.supported=["mp3","ogg","mp4","aac","wav"]),ion.sound=function(t){if(n(t,r),r.path=r.path||"",r.volume=r.volume||1,r.preload=r.preload||!1,r.multiplay=r.multiplay||!1,r.loop=r.loop||!1,r.sprite=r.sprite||null,r.scope=r.scope||null,r.ready_callback=r.ready_callback||null,r.ended_callback=r.ended_callback||null,p=r.sounds.length)for(h=0;h<p;h++){var s=(t=r.sounds[h]).alias||t.name;u[s]||(u[s]=new l(t),u[s].init())}else o("No sound-files provided!")},ion.sound.VERSION="3.0.7",ion.sound._method=function(t,s,i){if(s)u[s]&&u[s][t](i);else for(h in u)u.hasOwnProperty(h)&&u[h]&&u[h][t](i)},ion.sound.preload=function(t,s){n({preload:!0},s=s||{}),ion.sound._method("init",t,s)},ion.sound.destroy=function(t){if(ion.sound._method("destroy",t),t)u[t]=null;else for(h in u)u.hasOwnProperty(h)&&u[h]&&(u[h]=null)},ion.sound.play=function(t,s){ion.sound._method("play",t,s)},ion.sound.stop=function(t,s){ion.sound._method("stop",t,s)},ion.sound.pause=function(t,s){ion.sound._method("pause",t,s)},ion.sound.volume=function(t,s){ion.sound._method("volume",t,s)},i&&(i.ionSound=ion.sound),(s=t.AudioContext||t.webkitAudioContext)&&(a=new s);var l=function(t){this.options=n(r),delete this.options.sounds,n(t,this.options),this.request=null,this.streams={},this.result={},this.ext=0,this.url="",this.autoplay=this.no_file=this.decoded=this.loaded=!1};l.prototype={init:function(t){t&&n(t,this.options),this.options.preload&&this.load()},destroy:function(){var t;for(h in this.streams)(t=this.streams[h])&&t.destroy();this.streams={},this.result=null,this.options=this.options.buffer=null,this.request&&(this.request.removeEventListener("load",this.ready.bind(this),!1),this.request.removeEventListener("error",this.error.bind(this),!1),this.request.abort(),this.request=null)},createUrl:function(){var t=(new Date).valueOf();this.url=this.options.path+encodeURIComponent(this.options.name)+"."+this.options.supported[this.ext]+"?"+t},load:function(){this.no_file?o('No sources for "'+this.options.name+'" sound :('):this.request||(this.createUrl(),this.request=new XMLHttpRequest,this.request.open("GET",this.url,!0),this.request.responseType="arraybuffer",this.request.addEventListener("load",this.ready.bind(this),!1),this.request.addEventListener("error",this.error.bind(this),!1),this.request.send())},reload:function(){this.ext++,this.options.supported[this.ext]?this.load():(this.no_file=!0,o('No sources for "'+this.options.name+'" sound :('))},ready:function(t){this.result=t.target,4!==this.result.readyState?this.reload():200!==this.result.status&&0!==this.result.status?(o(this.url+" was not found on server!"),this.reload()):(this.request.removeEventListener("load",this.ready.bind(this),!1),this.request.removeEventListener("error",this.error.bind(this),!1),this.request=null,this.loaded=!0,this.decode())},decode:function(){a&&a.decodeAudioData(this.result.response,this.setBuffer.bind(this),this.error.bind(this))},setBuffer:function(t){if(this.options.buffer=t,this.decoded=!0,t={name:this.options.name,alias:this.options.alias,ext:this.options.supported[this.ext],duration:this.options.buffer.duration},this.options.ready_callback&&"function"==typeof this.options.ready_callback&&this.options.ready_callback.call(this.options.scope,t),this.options.sprite)for(h in this.options.sprite)this.options.start=this.options.sprite[h][0],this.options.end=this.options.sprite[h][1],this.streams[h]=new d(this.options,h);else this.streams[0]=new d(this.options);this.autoplay&&(this.autoplay=!1,this.play())},error:function(){this.reload()},play:function(t){if(delete this.options.part,t&&n(t,this.options),this.loaded){if(!this.no_file&&this.decoded)if(this.options.sprite)if(this.options.part)this.streams[this.options.part].play(this.options);else for(h in this.options.sprite)this.streams[h].play(this.options);else this.streams[0].play(this.options)}else this.autoplay=!0,this.load()},stop:function(t){if(this.options.sprite)if(t)this.streams[t.part].stop();else for(h in this.options.sprite)this.streams[h].stop();else this.streams[0].stop()},pause:function(t){if(this.options.sprite)if(t)this.streams[t.part].pause();else for(h in this.options.sprite)this.streams[h].pause();else this.streams[0].pause()},volume:function(t){if(t)if(n(t,this.options),this.options.sprite)if(this.options.part)(t=this.streams[this.options.part])&&t.setVolume(this.options);else for(h in this.options.sprite)(t=this.streams[h])&&t.setVolume(this.options);else(t=this.streams[0])&&t.setVolume(this.options)}};var d=function(t,s){this.alias=t.alias,this.name=t.name,this.sprite_part=s,this.buffer=t.buffer,this.start=t.start||0,this.end=t.end||this.buffer.duration,this.multiplay=t.multiplay||!1,this.volume=t.volume||1,this.scope=t.scope,this.ended_callback=t.ended_callback,this.setLoop(t),this.gain=this.source=null,this.paused=this.playing=!1,this.time_offset=this.time_played=this.time_ended=this.time_started=0};d.prototype={destroy:function(){this.stop(),this.source=this.buffer=null,this.gain&&this.gain.disconnect(),this.source&&this.source.disconnect(),this.source=this.gain=null},setLoop:function(t){this.loop=!0===t.loop?9999999:"number"==typeof t.loop&&+t.loop-1},update:function(t){this.setLoop(t),"volume"in t&&(this.volume=t.volume)},play:function(t){t&&this.update(t),!this.multiplay&&this.playing||(this.gain=a.createGain(),this.source=a.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.gain),this.gain.connect(a.destination),this.gain.gain.value=this.volume,this.source.onended=this.ended.bind(this),this._play())},_play:function(){var t,s;this.paused?(t=this.start+this.time_offset,s=this.end-this.time_offset):(t=this.start,s=this.end),0>=s?this.clear():("function"==typeof this.source.start?this.source.start(0,t,s):this.source.noteOn(0,t,s),this.playing=!0,this.paused=!1,this.time_started=(new Date).valueOf())},stop:function(){this.playing&&this.source&&("function"==typeof this.source.stop?this.source.stop(0):this.source.noteOff(0)),this.clear()},pause:function(){this.paused?this.play():this.playing&&(this.source&&this.source.stop(0),this.paused=!0)},ended:function(){this.playing=!1,this.time_ended=(new Date).valueOf(),this.time_played=(this.time_ended-this.time_started)/1e3,this.time_offset+=this.time_played,(this.time_offset>=this.end||.015>this.end-this.time_offset)&&(this._ended(),this.clear(),this.loop&&(this.loop--,this.play()))},_ended:function(){var t={name:this.name,alias:this.alias,part:this.sprite_part,start:this.start,duration:this.end};this.ended_callback&&"function"==typeof this.ended_callback&&this.ended_callback.call(this.scope,t)},clear:function(){this.time_offset=this.time_played=0,this.playing=this.paused=!1},setVolume:function(t){this.volume=t.volume,this.gain&&(this.gain.gain.value=this.volume)}},a||(function(){var t,s,i=(o=new Audio).canPlayType("audio/mpeg"),e=o.canPlayType("audio/ogg"),o=o.canPlayType('audio/mp4; codecs="mp4a.40.2"');for(s=0;s<r.supported.length;s++)t=r.supported[s],i||"mp3"!==t||r.supported.splice(s,1),e||"ogg"!==t||r.supported.splice(s,1),o||"aac"!==t||r.supported.splice(s,1),o||"mp4"!==t||r.supported.splice(s,1)}(),l.prototype={init:function(t){t&&n(t,this.options),this.inited=!0,this.options.preload&&this.load()},destroy:function(){var t;for(h in this.streams)(t=this.streams[h])&&t.destroy();this.streams={},this.inited=this.loaded=!1},load:function(){var t;if(this.options.preload=!0,this.options._ready=this.ready,this.options._scope=this,this.options.sprite)for(h in this.options.sprite)t=this.options.sprite[h],this.options.start=t[0],this.options.end=t[1],this.streams[h]=new d(this.options,h);else this.streams[0]=new d(this.options)},ready:function(t){this.loaded||(this.loaded=!0,t={name:this.options.name,alias:this.options.alias,ext:this.options.supported[this.ext],duration:t},this.options.ready_callback&&"function"==typeof this.options.ready_callback&&this.options.ready_callback.call(this.options.scope,t),this.autoplay&&(this.autoplay=!1,this.play()))},play:function(t){if(this.inited)if(delete this.options.part,t&&n(t,this.options),console.log(1),this.loaded)if(this.options.sprite)if(this.options.part)this.streams[this.options.part].play(this.options);else for(h in this.options.sprite)this.streams[h].play(this.options);else this.streams[0].play(this.options);else this.options.preload?this.autoplay=!0:(this.autoplay=!0,this.load())},stop:function(t){if(this.inited)if(this.options.sprite)if(t)this.streams[t.part].stop();else for(h in this.options.sprite)this.streams[h].stop();else this.streams[0].stop()},pause:function(t){if(this.inited)if(this.options.sprite)if(t)this.streams[t.part].pause();else for(h in this.options.sprite)this.streams[h].pause();else this.streams[0].pause()},volume:function(t){if(t)if(n(t,this.options),this.options.sprite)if(this.options.part)(t=this.streams[this.options.part])&&t.setVolume(this.options);else for(h in this.options.sprite)(t=this.streams[h])&&t.setVolume(this.options);else(t=this.streams[0])&&t.setVolume(this.options)}},(d=function(t,s){this.name=t.name,this.alias=t.alias,this.sprite_part=s,this.multiplay=t.multiplay,this.volume=t.volume,this.preload=t.preload,this.path=r.path,this.start=t.start||0,this.end=t.end||0,this.scope=t.scope,this.ended_callback=t.ended_callback,this._scope=t._scope,this._ready=t._ready,this.setLoop(t),this.url=this.sound=null,this.loaded=!1,this.played_time=this.paused_time=this.start_time=0,this.init()}).prototype={init:function(){this.sound=new Audio,this.sound.volume=this.volume,this.createUrl(),this.sound.addEventListener("ended",this.ended.bind(this),!1),this.sound.addEventListener("canplaythrough",this.can_play_through.bind(this),!1),this.sound.addEventListener("timeupdate",this._update.bind(this),!1),this.load()},destroy:function(){this.stop(),this.sound.removeEventListener("ended",this.ended.bind(this),!1),this.sound.removeEventListener("canplaythrough",this.can_play_through.bind(this),!1),this.sound.removeEventListener("timeupdate",this._update.bind(this),!1),this.sound=null,this.loaded=!1},createUrl:function(){var t=(new Date).valueOf();this.url=this.path+encodeURIComponent(this.name)+"."+r.supported[0]+"?"+t},can_play_through:function(){this.preload&&this.ready()},load:function(){this.sound.src=this.url,this.sound.preload=this.preload?"auto":"none",this.preload&&this.sound.load()},setLoop:function(t){this.loop=!0===t.loop?9999999:"number"==typeof t.loop&&+t.loop-1},update:function(t){this.setLoop(t),"volume"in t&&(this.volume=t.volume)},ready:function(){!this.loaded&&this.sound&&(this.loaded=!0,this._ready.call(this._scope,this.sound.duration),this.end||(this.end=this.sound.duration))},play:function(t){t&&this.update(t),!this.multiplay&&this.playing||this._play()},_play:function(){if(this.paused)this.paused=!1;else try{this.sound.currentTime=this.start}catch(t){}this.playing=!0,this.start_time=(new Date).valueOf(),this.sound.volume=this.volume,this.sound.play()},stop:function(){if(this.playing){this.paused=this.playing=!1,this.sound.pause(),this.clear();try{this.sound.currentTime=this.start}catch(t){}}},pause:function(){this.paused?this._play():(this.playing=!1,this.paused=!0,this.sound.pause(),this.paused_time=(new Date).valueOf(),this.played_time+=this.paused_time-this.start_time)},_update:function(){this.start_time&&(this.played_time+((new Date).valueOf()-this.start_time))/1e3>=this.end&&this.playing&&(this.stop(),this._ended())},ended:function(){this.playing&&(this.stop(),this._ended())},_ended:function(){this.playing=!1;var t={name:this.name,alias:this.alias,part:this.sprite_part,start:this.start,duration:this.end};this.ended_callback&&"function"==typeof this.ended_callback&&this.ended_callback.call(this.scope,t),this.loop&&setTimeout(this.looper.bind(this),15)},looper:function(){this.loop--,this.play()},clear:function(){this.paused_time=this.played_time=this.start_time=0},setVolume:function(t){this.volume=t.volume,this.sound&&(this.sound.volume=this.volume)}})}}}(window,navigator,window.jQuery||window.$);